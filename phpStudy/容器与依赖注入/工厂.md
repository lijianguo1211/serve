### 设计模式之工厂工模

我们在说什么是依赖注入之前，先来讲讲什么是工厂设计模式

说一个我们生活中很常见的例子，我们做一款购物app，在这个购物app中，我们有：

- 抢购 =》 【Rush to buy】
- 团购 =》 【Group buying】
- 积分换购 =》 【integral buy】
- 优惠券购物 =》 【Coupon buy】
- 正常购物 =》 【normal buy】

```php
<?php
namespace App;
class RushToBuy
{
    protected $rush;
    
    public function doSomeThing()
    {
        //...
    }
}
?>

<?php
namespace App;
class GroupBuying
{
    protected $group;
        
    public function doSomeThing()
    {
            //...
    }
}

?>

<?php
namespace App;
class IntegralBuy
{
    protected $integral;
        
    public function doSomeThing()
    {
            //...
    }
}

?>

<?php
namespace App;
class CouponBuy
{
    protected $coupon;
        
    public function doSomeThing()
    {
            //...
    }
}

?>

<?php
namespace App;
class NormalBuy
{
    protected $normal;
        
    public function doSomeThing()
    {
            //...
    }
}
?>
```

现在我们要操作这些类的里面的方法的话，就只能是`use ....`,这样一个一个引入的操作吗？就像下面这样的：
我们要使用不同类里面的方法，如果我们正常来写的话，那就是我们用到谁，就use谁，然后new它一下，就OK了，

```php
<?php
namespace App\Http;
use App\RushToBuy;
use App\GroupBuying;
use App\IntegralBuy;
use App\CouponBuy;
use App\NormalBuy;

class Test
{
    public function go()
    {
        (new RushToBuy)->doSomeThing();
        (new GroupBuying)->doSomeThing();
        (new IntegralBuy)->doSomeThing();
        (new CouponBuy)->doSomeThing();
        (new NormalBuy)->doSomeThing();
    }
}

```
向上面这样的操作，如果是我们只是在一个类里面使用的话，就没什么问题，如果是多个类都要使用它们里面的方法呢，这个时候，我们就要不停的use ，不停的new
这样对于我来说是不是一种折磨呀，老是重复做同样的事儿，这可不是我们的风格哦。
于是我们就要想办法，怎么样我们只用use它一次，new它一次，以后就可以直接使用了呢。于是我们就想到这样操作 ===》 我们先写一个中间类Middle
```php
<?php 
namespace App;
use App\RushToBuy;
use App\GroupBuying;
use App\IntegralBuy;
use App\CouponBuy;
use App\NormalBuy;

class Middle
{
    public function goMiddle($className)
    {
        switch($className)
        {
            case 'rush':
                return new RushToBuy;
                break;
            case 'group':
                return new GroupBuying;
                break;
            case 'integral':
                return new IntegralBuy;
                break;
            case 'coupon':
                return new CouponBuy;
                break;
            case 'norma':
                return new NormalBuy;
                break;
            default:
                return false;
                break;
        }
    }
}
```

我们这个时候有Middle这个中间类了，那么我们再看上面的Test类，我们就可以不用那样写了。
```php
<?php
namespace App\Http;
use App\Middle;

class Test
{
    public function go()
    {
        $middleModle = new Middle();
        $middleModle->goMiddle('rush');
        $middleModle->goMiddle('group');
        $middleModle->goMiddle('norma');
        $middleModle->goMiddle('coupon');
    }
}
```

此时我们并没有直接操作我们需要的方法类，我们通过中间类去操作它们，这样就大大简化了我们的代码量，看起来也是舒服很多，而且就算很多方法都需要它们去做事，
我们也只是操作这个中间类一下就可以了。
这就好像是我们不管有多少类，都把它放入这个中间类里加工一下。我们再来操作就简化了很多。其实这个中间类的功能就是和工厂模式一样。
它就是一个加工厂，我们把需要加工的东西，注入到加工厂的机器里，然后机器加工一下，我们操作的是加工后的东西。

